#       $NetBSD: CHANGES-4.0,v 1.1.4.50 2007/01/21 17:10:17 bouyer Exp $

A complete list of changes from the initial NetBSD 4.0 branch on
1 December 2006 until the 4.0 release:

gnu/usr.bin/groff/tmac/mdoc.local		patched by hand
sys/sys/param.h					patched by hand

	Welcome to 4.0_BETA2

sys/lib/libsa/dosfs.c				1.11

	make bootxx_msdos fit in 8k again; thanks, __internal_memset_, for
	spilling registers all over the place.
	[dogcow, ticket #240]

sys/uvm/uvm_swap.c				1.114

	We are required to hold uvm.swap_data_lock here too.
	[elad, ticket #241]

sys/dev/pci/ahcisata.c				1.2

	Don't call the done callback twice if a special action is waiting on
	the queue. Don't forget to free the xfer in the normal bio path.
	[bouyer, ticket #242]

usr.bin/msgc/msg_sys.def			1.37

	Eliminate an alloca(3) use. This is required for USE_SSP builds to
	complete.
	[tls, ticket #243]

sys/conf/Makefile.kern.inc			1.95

	Add arch/xen/i386/gdt.c to list of kernel files that do variable-size
	allocations on the stack. This allocation could potentially be quite
	large -- I am not sure how to best fix that.
	Fixes USE_SSP i386 build.sh failure.
	[tls, ticket #244]

share/man/man9/kauth.9				1.37
sys/dev/i2o/dpti.c				1.31
sys/dev/i2o/iop.c				1.62
sys/dev/ic/dpt.c				1.55
sys/dev/ic/icp_ioctl.c				1.14
sys/dev/ic/mlx.c				1.49
sys/dev/pci/amr.c				1.43
sys/dev/pci/mly.c				1.33
sys/dev/pci/twe.c				1.82
sys/dev/tc/stic.c				1.37
sys/kern/kern_auth.c				1.33
sys/secmodel/bsd44/secmodel_bsd44_securelevel.c	1.19
sys/sys/kauth.h					1.25

	Change kauth(9) KPI for kauth_authorize_device_passthru() to add
	another argument, u_long, serving as a bit-mask of generic requests
	for the passthru request.
	[elad, ticket #247]

doc/CHANGES					patch

	Add entry for etherip(4).
	[rpaulo, ticket #249]

sys/miscfs/procfs/procfs_vnops.c		1.141

	Make procfs work again for non-root users.
	[elad, ticket #248]

gnu/usr.bin/gdb53/libiberty/Makefile		1.5

	Fix SSP build for the poor archs that have not converted yet.
	[tls, ticket #250]

gnu/usr.bin/gdb53/gdb/Makefile			1.8

	Allow to build NetBSD-amd64 with USE_SSP set.
	[tls, ticket #251]

sys/ufs/ffs/ffs_snapshot.c			1.38

	Prevent kernel panics when creating snapshots on filesystems which
	uses quotas. This fixes PR kern/35121.
	[hannken, ticket #252]

share/man/man9/scheduler.9			1.4

	Update to describe current API (only), and not duplicate that can be
	found elsewhere. (And which will appear in the NetBSD Internals Guide
	soonish).
	Submitted by Daniel Sieger <dsieger@TechFak.Uni-Bielefeld.DE>,
	OK'd by martin@ and  yamt@
	[hubertf, ticket #253]

sys/arch/sparc/conf/GENERIC			1.197
sys/arch/sparc64/conf/GENERIC			1.80

	sparc64: don't enable PaX MPROTECT by default for now.
	sparc: add commented out 'FILEASSOC'.
	[elad, ticket #254]

usr.sbin/veriexecgen/veriexecgen.8		1.9
usr.sbin/veriexecgen/veriexecgen.c		1.9

	More verbose error messages in veriexecgen(8).
	Also introduce a new -W flag, which will warn the user about the
	error, but will still continue processing - it treats errors as
	warnings, and allows a signatures file to be built.
	[elad, ticket #255]

distrib/utils/sysinst/net.c			1.114

	Ensure the generated ifconfig.* file has proper media selection.
	[martin, ticket #256]

sys/kern/kern_resource.c			1.109

	Fix PR/35021: allow root cannot get/set rlimit information of user
	processes through sysctl again.
	[elad, ticket #257]

distrib/hp700/ramdisk/dot.profile		1.2
distrib/hp700/ramdisk/dot.profile		1.2
distrib/hp700/ramdisk/list			1.4
distrib/hp700/ramdisk/list			1.4
etc/etc.hp700/MAKEDEV.conf			1.3
etc/etc.hp700/MAKEDEV.conf			1.3
sys/arch/hp700/conf/majors.hp700		1.21
sys/arch/hp700/conf/majors.hp700		1.21

	Various installation fixes for hp700.
	[skrll, ticket #258]

sys/netinet/ip_etherip.c			1.2
sys/netinet6/ip6_etherip.c			1.2

	Allow etherip support to be compiled on ports other than i386.
	[jdc, ticket #259]

share/man/man9/uvm.9				1.79
sys/uvm/uvm_extern.h				1.123
sys/uvm/uvm_swap.c				1.115

	Back out uvm_is_swap_device().
	[elad, ticket #261]

sys/arch/i386/i386/powernow_k7.c		1.21

	Add another model that needs to be added into the quirk table.
	[xtraeme, ticket #262]

lib/libc/arch/sparc64/gen/resumecontext.c	1.3

	getcontext(2)/setcontext(2) fixes for sparc64.
	[martin, ticket #263]

lib/libc/arch/arm/gen/resumecontext.c		1.3
lib/libc/arch/hppa/gen/resumecontext.c		1.2
lib/libc/arch/mips/gen/resumecontext.c		1.3
lib/libc/arch/powerpc/gen/resumecontext.c	1.3
lib/libc/arch/powerpc64/gen/resumecontext.c	1.2
lib/libc/arch/sh3/gen/resumecontext.c		1.3
lib/libc/arch/sh5/gen/resumecontext.c		1.2
lib/libc/arch/sparc/gen/resumecontext.c		1.3
lib/libc/arch/vax/gen/resumecontext.c		1.2

	getcontext(2)/setcontext(2) fixes for arm, hppa, mips, powerpc,
	powerpc64, sh3,  sh5, sparc, vax.
	[martin, ticket #264]

sbin/veriexecctl/veriexecctl_parse.y		1.20

	fixes a bug where entries with multiple flags only counted the
	last flag.
	[elad, ticket #265]

doc/3RDPARTY					1.489
share/zoneinfo/zone.tab				1.1.1.27 via patch
share/zoneinfo/australasia			1.12

	tz{code,data}2006p out; tzdata2006p imported.
	[kleink, ticket #260]

sys/arch/xen/x86/consinit.c			1.7

	Remove extra ) causing compile failure when CONS_OVERRIDE is defined.
	From Hideo Masuda in PR port-xen/35217.
	[bouyer, ticket #266]

sys/dev/pci/pcidevs				1.857
sys/dev/pci/pcidevs.h				regen
sys/dev/pci/pcidevs_data.h			regen

	Add another PCI ID for Dell PERC 5.
	[bouyer, ticket #267]

share/man/man9/KASSERT.9			1.3

	Fix description to match the code.
	[pooka, ticket #268]

sys/miscfs/deadfs/dead_vnops.c			1.43

	Teach deadfs about vm object locking for getpages. This avoids
	errors resulting from situations where we take a page fault for a
	vnode which has been converted a deadfs vnode.
	[pooka, ticket #269]

sys/dev/sbus/stp4020.c				1.49

	Fix build of STP4020 SBus/PCMCIA driver.
	[jdc, ticket #270]

gnu/dist/gcc4/gcc/config/pa/pa.md		1.2

	Fix PA code generatation on 64bit hosts.
	[skrll, ticket #271]

sys/arch/mac68k/dev/if_mc.c			1.28
sys/arch/mac68k/dev/if_mcvar.h			1.12
sys/arch/mac68k/obio/if_mc_obio.c		1.16

	Convert DMA memory allocation to bus_dmamem_alloc.
	[martin, ticket #272]

lib/libc/arch/m68k/gen/resumecontext.S		1.4

	Fix regression tests in "regress/lib/libc/context" for m68k based
	NetBSD ports.
	[martin, ticket #273]

sys/kern/kern_verifiedexec.c			1.80

	entry-type is uint8.
	[elad, ticket #274]

sys/kern/kern_verifiedexec.c			1.81

	Call veriexec_table_delete() in the cases where we won't be failing the
	unmount request.  PR#35252.
	[elad, ticket #275]

usr.bin/cdplay/cdplay.c				1.35

	Take into account the 150 frame start offset time when computing the
	duration of a track.
	[chuck, ticket #276]

sys/netbt/l2cap_signal.c			1.3

	Do not use the output buffer to store data unless we mean it to go
	in the packet, as there is a problem with overwriting information
	while we still need it (opt->length in particular) which causes
	connections to fail.
	[plunky, ticket #277]

sys/dev/pci/eso.c				1.46-1.47

	Un-break clock selection after -Wsign-compare cleanup in rev. 1.43;
	from Stephen Ma in PR kern/35220.
	[kleink, ticket #278]

share/dict/web2					1.15

	Remove an accidentally duplicated word. This also fixes regression
	tests in "regress/lib/libc/db regression".
	[martin, ticket #279]

sys/net/if_fddisubr.c				1.64
sys/net/if_llc.h				1.17
sys/netiso/clnp_input.c				1.32,1.34

	Fix iso(4) over FDDI.
	[is, ticket #280]

usr.bin/column/column.c				1.16

	Stop column(1) from generating an infinite stream of NUL characters.
	This could cause "/etc/security" to fill up "/tmp" during the
	nightly security check.
	[jdc, ticket #281]

sys/arch/alpha/conf/GENERIC			1.302-1.305
sys/arch/alpha/conf/INSTALL			1.91-1.92

	Add the following network devices:
	- pcn at pci
	- wm at pci
	- makphy at mii
	- rgephy at mii
	- rlphy at mii
	and reduce diffs between GENERIC and INSTALL.
	[tsutsui, ticket #282]

share/man/man4/re.4				1.11
sys/dev/ic/rtl8169.c				1.74

	Fix and reenable HW VLAN tagging on re(4):
	- clear re_vlanctl in DMA descriptors before starting TX and RX
	  to avoid stale tags
	- use bswap16() rather than be16toh() or htons() on VLAN tag access
	  since we already use htole32()

	Closes PR kern/32643 and also fixes HW VLAN tagging on big endian
	machines.

	[tsutsui, ticket #283]

distrib/utils/sysinst/arch/i386/msg.md.de	1.9
distrib/utils/sysinst/arch/i386/msg.md.en	1.51
distrib/utils/sysinst/arch/i386/msg.md.es	1.4
distrib/utils/sysinst/arch/i386/msg.md.fr	1.41
distrib/utils/sysinst/arch/i386/msg.md.pl	1.24

	Update message strings to match reordered kernels after TINY ones got
	killed.  Fixes PR/35264
	[dsl, ticket #284]

usr.bin/make/cond.c				1.36
usr.bin/make/main.c				1.138-1.139
usr.bin/make/make.h				1.65
usr.bin/make/parse.c				1.121-1.124
usr.bin/make/targ.c				1.46

	performance improvements and bug fixes for make(1)
	[dsl, ticket #285]

sys/arch/mips/mips/pmap.c			1.169

	Fixes panic running regress/sys/kern/umount on MIPS platforms
	reported by Martin Husemann.
	[simonb, ticket #289]

sys/conf/Makefile.kern.inc			1.97

	use -fstack-protector instead of -fstack-protector-all since this breaks
	on amd64 (it works on sparc64).
	[tls, ticket #290]

sys/conf/Makefile.kern.inc			1.98

	Fix for SSP enabled Xen kernels
	[tls, ticket #291]

share/man/man9/veriexec.9			1.10

	Markup fix - forgot 'Fn'.
	[elad, ticket #292]

sys/netinet6/ipsec.c				1.114

	do not compare ipv6 ipsec tunnel addresses against uninitialized data.
	Fixes PR kern/34734
	[mlelstv, ticket #293]

distrib/sets/lists/man/mi			1.958
share/man/man4/Makefile				1.416
share/man/man4/mfi.4				1.1-1.2
sys/arch/amd64/conf/GENERIC			1.122
sys/arch/amd64/conf/INSTALL			1.61
sys/arch/i386/conf/ALL				1.75
sys/arch/i386/conf/GENERIC			1.802
sys/arch/i386/conf/INSTALL			1.298
sys/arch/i386/conf/XEN2_DOM0			1.19
sys/conf/files					1.821
sys/dev/ic/mfi.c				1.1-1.2
sys/dev/ic/mfireg.h				1.1-1.2
sys/dev/ic/mfivar.h				1.1-1.2
sys/dev/pci/files.pci				1.274
sys/dev/pci/mfi_pci.c				1.1-1.2

	Add mfi(4), a driver for LSI Logic & Dell MegaRAID SAS RAID controller.
	Tested on NetBSD-i386 and NetBSD-amd64.
	[bouyer, ticket #286]

distrib/sets/lists/man/mi			1.959
share/man/man4/Makefile				1.417
share/man/man4/bnx.4				1.1-1.2
sys/arch/amd64/conf/GENERIC			1.123
sys/arch/amd64/conf/INSTALL			1.62
sys/arch/i386/conf/ALL				1.76
sys/arch/i386/conf/GENERIC			1.803
sys/arch/i386/conf/GENERIC_LAPTOP		1.218
sys/arch/i386/conf/INSTALL			1.299
sys/arch/i386/conf/INSTALL_LAPTOP		1.112
sys/arch/i386/conf/XEN2_DOM0			1.20
sys/dev/microcode/bnx/bnxfw.h			1.1-1.2
sys/dev/pci/files.pci				1.275
sys/dev/pci/if_bnx.c				1.1
sys/dev/pci/if_bnxreg.h				1.1

	Add bnx(4), a driver for Broadcom NetXtreme II 10/100/1000 Ethernet
	device. Tested on NetBSD-i386 and NetBSD-amd64.
	[bouyer, ticket #287]

share/man/man4/pci.4				1.85

	Add references to bnx(4) and mfi(4).
	[bouyer, ticket #288]

sys/kern/exec_script.c				1.53
sys/kern/kern_exec.c				1.233
sys/sys/exec.h					1.115

	Remove the third argument from check_exec() and just check for ep_flags
	in the exec_package to know if we need to use VERIEXEC_DIRECT or
	VERIEXEC_INDIRECT.
	[elad, ticket #294]

sys/dist/ipf/netinet/ip_state.c			1.16

	TCP window scaling was being recognised but the recorded settins were
	being clobbered and thus effectively disabled.
	[darrenr, ticket #303]

sys/kern/subr_prof.c				1.37

	Add missing initializer.  PR#35248
	[liamjfoy, ticket #295]

sys/dev/pci/if_iwi.c				1.59
sys/dev/pci/if_iwireg.h				1.17
sys/dev/pci/if_iwivar.h				1.13

	Several fixes for iwi(4).
	[skrll, ticket #296]

sys/dev/ieee1394/fwohci.c			1.104

	Fix memory allocation, in case isochronous transfer fails.
	[kiyohara, ticket #297]

sbin/sysctl/sysctl.c				1.122

	PR/35304: C J Coleman: Off-by-one nul byte overwrite in mode_bits
	routine of sbin/sysctl
	[elad, ticket #298]

sys/kern/kern_exec.c				1.234

	Use ndp->ni_cnd.cn_pnbuf, not epp->ep_ndp->ni_dirp, for the pathname
	for Veriexec/PaX purposes.  Fixes part of PR/35278.
	[elad, ticket #299]

usr.bin/netstat/show.c				1.6

	Fix minor display error.
	[jdc, ticket #300]

etc/daily					1.69

	Make the daily script immune to changes of the current working
	directory in /etc/daily.local.  PR#33461.
	[hubertf, ticket #301]

distrib/notes/sgimips/hardware			1.13
distrib/notes/sgimips/prep			1.7

	Add note on handling the O2 framebuffer, and how to work around the
	non-support, by giving instructions for a serial console.
	[hubertf, ticket #302]

sys/arch/i386/conf/INSTALL			1.300

	Remove the ppp(4) driver from the INSTALL kernel, without pppd it
	is not useful. Should make the install system fit on a 2.88M floppy.
	[dogcow, ticket #327]

sys/kern/vfs_lookup.c				1.76
sys/kern/vfs_syscalls.c				1.282
sys/sys/namei.h					1.47

	Fix PR kern/35278: veriexec sometimes feeds user va to log(9).
	[elad, ticket #304]

sys/miscfs/procfs/procfs_vnops.c		1.142

	Fix procfs for Linux applications.
	[elad, ticket #307]

lib/libc/arch/sparc64/sys/__clone.S		1.5

	Make regression test in "regress/lib/libc/clone" work under
	NetBSD-sparc64. This fixes PR port-sparc64/33075.
	[martin, ticket #309]

sys/miscfs/procfs/procfs_vnops.c		1.144
sys/secmodel/bsd44/secmodel_bsd44_suser.c	1.21 via patch

	PR kern/35226: Problems with permissions in "/usr/pkg/emul/linux/proc".
	[elad, ticket #308]

share/man/man9/kauth.9				1.39
sys/miscfs/procfs/procfs_ctl.c			1.38
sys/sys/kauth.h					1.27

	pullup KAUTH_REQ_PROCESS_CANPROCFS_CTL and associated changes,
	to make the netbsd-4 branch build again.
	[hubert, ticket #334]

share/man/man9/veriexec.9			1.11
sys/kern/kern_verifiedexec.c			1.85
sys/sys/verified_exec.h				1.47

	veriexec_lookup() should not return an internal data-structure, but
	rather just a boolean value.
	[elad, ticket #310]

lib/libc/arch/sparc64/sys/__clone.S		1.6

	After discussing this further with uwe, rearange stack usage slightly
	and replace a comment with words suggested by him.
	[martin, ticket #311]

lib/libc/arch/sparc/gen/setjmp.S		1.10
lib/libc/arch/sparc/sys/__clone.S		1.4
lib/libc/arch/sparc/sys/cerror.S		1.9

	Use CCFSZ instead of 96 for standard save operations.
	[martin, ticket #312]

lib/libc/arch/sparc/sys/__clone.S		1.5

	Provide a full frame stack space in the clone'd child.
	[martin, ticket #313]

sys/kern/kern_pax.c				1.11
sys/kern/kern_verifiedexec.c			1.86

	Fix copy/paste error: Veriexec's sysctl setup routine was named after
	PaX's.
	[elad, ticket #314]

sys/kern/kern_verifiedexec.c			1.87

	Veriexec should not explicitly allow anything (raw disk access).
	[elad, ticket #315]

sys/arch/vax/vax/in4_cksum.c			1.11
sys/arch/vax/vax/in_cksum.c			1.10

	GCC constraints error for inline assembler, causing in_cksum to
	calculate the checksum wrong in the non-optimized case.
	Fix provided in PR#14614 by Rhialto, so this solves this PR.
	[ragge, ticket #321]

sys/arch/hppa/hppa/trap.c			1.39
sys/uvm/uvm_unix.c				1.37

	Update uvm_grow to support stacks that grow upwards.
	Use on hppa and fix a bug in the hppa trap handler.
	[skrll, ticket #323]

sys/dev/cgdvar.h				1.6-1.8

	int -> size_t, fix build on 64-bit architectures
	[jdc, ticket #326]

share/man/man4/iwi.4				1.6

	Reflect changed name of the firmware package after the update to
	version 3.
	[joerg, ticket #328]

sys/arch/i386/conf/INSTALL_XEN2_DOMU		1.10

	Having ppp(4) and sl(4) enabled in this kernel configuration is
	completely pointless because it doesn't support any serial interfaces.
	[tron, ticket #330]

sys/arch/amd64/conf/INSTALL			1.63
sys/arch/i386/conf/INSTALL_LAPTOP		1.113

	Disable ppp(4) because pppd(8) isn't on the installation image anyway.
	[tron, ticket #331]

sys/fs/udf/udf.h				1.9
sys/fs/udf/udf_subr.c				1.26
sys/fs/udf/udf_vfsops.c				1.19

	Implement read-only access to UDF 2.50 and UDF 2.60 discs that use
	metadata partition mappings. This brings the NetBSD implementation
	to read all discs upto date and will read all discs currently
	defined by OSTA.
	[reinoud, ticket #332]

sys/fs/udf/ecma167-udf.h			1.6
sys/fs/udf/udf_subr.c				1.27-1.29
sys/fs/udf/udf_vnops.c				1.9

	Fix various issues related to ticket #332
	[reinoud, ticket #333]

sys/dev/pci/ahcisata.c				1.3

	Don't print version 1.0 if we have a version 1.1 controller.
	[bouyer, ticket #329]

regress/sys/fs/tmpfs/t_remove			1.8
sys/fs/tmpfs/tmpfs_vnops.c			1.34

	* fix locking gotchas when trying to unlink "."
	* return standard EPERM when trying to unlink a directory
	* reorder some checks in rmdir avoid problems if trying to rmdir ".."
	* add a test to check that unlink of "." is not succesful
	[pooka, ticket #324]

share/examples/secmodel/secmodel_example.c	1.10 via patch
share/man/man9/kauth.9				1.43 via patch
share/man/man9/secmodel_bsd44.9			1.9
sys/arch/alpha/alpha/machdep.c			1.291
sys/arch/amd64/amd64/netbsd32_machdep.c		1.31
sys/arch/amd64/amd64/sys_machdep.c		1.10
sys/arch/arm/arm32/mem.c			1.17 via patch
sys/arch/i386/i386/sys_machdep.c		1.79
sys/arch/pc532/pc532/mem.c			1.43 via patch
sys/arch/powerpc/powerpc/mem.c			1.27 via patch
sys/arch/sh3/sh3/mem.c				1.23 via patch
sys/arch/sh5/sh5/mem.c				1.14 via patch
sys/arch/vax/vax/mem.c				1.34 via patch
sys/arch/x86/x86/x86_machdep.c			1.5
sys/arch/xen/i386/sys_machdep.c			1.10
sys/kern/kern_auth.c				1.35
sys/secmodel/bsd44/secmodel_bsd44_securelevel.c	1.20
sys/secmodel/bsd44/secmodel_bsd44_suser.c	1.22 via patch
sys/sys/kauth.h					1.29 via patch

	Make machdep scope architecture-agnostic by removing all arch-specific
	requests and centralizing them all. The result is that some of these
	are not used on some architectures, but the documentation was updated
	to reflect that.
	[elad, ticket #316]

sys/compat/linux/arch/i386/linux_machdep.c	1.120
sys/dev/wscons/wsdisplay_compat_usl.c		1.38

	Adapt to recent machdep scope changes.
	[elad, ticket #317]

sys/kern/kern_verifiedexec.c			1.88
sys/kern/vfs_vnops.c				1.130
sys/sys/verified_exec.h				1.48

	Avoid TOCTOU in Veriexec by introducing veriexec_openchk() to enforce
	the policy and using a single namei() call in vn_open().
	[elad, ticket #318]

share/man/man9/veriexec.9			1.12

	Document veriexe_openchk().
	[elad, ticket #320]

share/man/man9/kauth.9				1.44
sys/kern/kern_auth.c				1.36

	Make kauth_deregister_scope() and kauth_unlisten_scope() free the
	passed kauth_scope_t and kauth_listener_t objects, respectively.
	[elad, ticket #322]

sys/secmodel/bsd44/secmodel_bsd44_securelevel.c	1.25

	Consistent naming in sysctl(9) setup routines.
	[elad, ticket #325]

sys/arch/mac68k/dev/if_ae.c			1.79

	If we have a single byte left over after filling in all mbuf data, we
	need to increase the "totlen" count too. From Sungwon Chung.
	[martin, ticket #335]

sys/kern/kern_auth.c				1.34

	Allocate space for scopes and listeners with kmem.
	[elad, ticket #339]

sys/net/if_ethersubr.c				1.142

	Make kernel without ISO or NETATALK build. This fixes PR kern/35364.
	[bouyer, ticket #337]

sys/arch/xen/xen/xbd_xenbus.c			1.16

	Avoid kernel panic at boot if more than one xbd device is configured.
	[bouyer, ticket #338]

sys/arch/xen/xen/xencons.c			1.20

	Fix Xen console hangs.
	[bouyer, ticket #342]

share/man/man4/it.4				1.3
sys/dev/isa/it.c				1.7
sys/dev/isa/itvar.h				1.3

	- Remove unused sensors.
	- Provide more rfact values for the voltage sensors.
	- Remove the limit of 1.5 seconds for refreshing the sensors.
	[xtraeme, ticket #340]

sys/arch/mac68k/mac68k/locore.s			1.146

	Avoid kernel panic before reboot. This fixes PR port-mac68k/35068.
	[chs, ticket #345]

xsrc/xfree/xc/programs/Xserver/dbe/dbe.c		1.2
xsrc/xfree/xc/programs/Xserver/render/render.c	1.3
xsrc/xorg/xserver/xorg/dbe/dbe.c			1.2
xsrc/xorg/xserver/xorg/render/render.c		1.2

	fix integer overflow in dbe and render extensions
	(CVE-2006-6101, CVE-2006-6102 and CVE-2006-6103), from xfree86 CVS

	apply the xorg vendor patch for CVE-2006-6101, CVE-2006-6102 and
	CVE-2006-6103; afaict nothing is built from these sources yet
	[drochner, ticket #363]

distrib/sets/lists/man/mi			1.965
share/man/man4/Makefile				1.418
share/man/man4/envsys.4				1.21
share/man/man4/ug.4				1.1
sys/arch/amd64/conf/GENERIC			1.124
sys/dev/isa/files.isa				1.145
sys/dev/isa/ug.c				1.1
sys/dev/isa/ugvar.h				1.1

	Driver for the Abit uGuru Hardware system monitor, contributed by
	Mihai Chelaru. Minor changes (simplification and KNF) by me.
	[xtraeme, ticket #341]

gnu/dist/gcc4/gcc/config.gcc			1.15

	apply part of gcc SVN rev 112421 (for building on solaris):
		* config.gcc (sh*-*-*): Don't use c-c ranges for tr.
	[chs, ticket #343]

sys/arch/acorn32/conf/Makefile.acorn32		1.20
	feed /dev/null to awk for building modedef.c (for building on solaris).
	[chs, ticket #344]

sys/ufs/ext2fs/ext2fs_alloc.c			1.33
sys/ufs/ext2fs/ext2fs_inode.c			1.56

	several ext2fs fixes provided by Barry Bouwsma:
	 - set ip->i_e2fs_dtime to time_second, not time_uptime.
	 - don't allow ipref to go negative
	 - fs->e2fs.e2fs_icount is a valid inode number, allow it.
	[chs, ticket #346]

sys/arch/bebox/stand/elf2pef/elf2pef.c		1.13
sys/arch/bebox/stand/mkbootimage/mkbootimage.c	1.7

	don't include <sys/endian.h> when building as a host tool.
	[chs, ticket #347]

sys/lib/libsa/loadfile.c			1.25

	in fdloadfile(), fail if we can't read the entire exec header.
	[chs, ticket #348]

sys/arch/macppc/dev/ofb.c			1.53
sys/arch/macppc/dev/ofb_cons.c			1.2

	(hopefully) fix a panic when ofb attaches without being console
	[macallan, ticket #349]

sys/arch/shark/conf/files.shark			1.12
sys/arch/shark/isa/isa_io.c			1.7
sys/arch/shark/ofw/igsfb_ofbus.c		1.1
sys/arch/shark/ofw/igsfb_ofbusvar.h		1.1
sys/arch/shark/shark/consinit.c			1.5

	add glue for igsfb at ofbus
	[macallan, ticket #350]

sys/arch/shark/conf/GENERIC			1.68

	add igsfb at ofbus
	[macallan, ticket #351]

sys/arch/macppc/dev/mediabay.c			1.12

	when powering up the mediabay wait two seconds before looking for 
	devices
	Without this CDROM drives wouldn't be found when hotplugged.
	[macallan, ticket #352]

sys/arch/macppc/dev/ofb_cons.c			1.3
sys/arch/macppc/macppc/machdep.c		1.143

	make ofb compile without wsdisplay
	[macallan, ticket #353]

distrib/sets/lists/xserver/md.shark		1.7
share/mk/bsd.x11.mk				1.54
x11/Xserver/Makefile.common			1.33
x11/Xserver/hw/xfree86/drivers/Makefile		1.16
x11/Xserver/hw/xfree86/xf86_os/Makefile		1.14

	build XFree86 on shark
	[macallan, ticket #354]

xsrc/xsrc/xfree/xc/programs/Xserver/hw/xfree86/drivers/wsfb/wsfb_driver.c	1.7

	correctly report fb memory on wsfb
	[macallan, ticket #355]

sys/dev/ic/wdc.c				1.244
sys/dev/scsipi/cd.c				1.261

	fix PR 34202 by removing the alignement constraints on PIO data
	transfers and undo the alignment hacks used previously to work
	around the problem.
	[martin, ticket #371]

lib/Makefile					1.112

	take into account that libpam depends on libkafs, fixes parallel
	builds.
	[bouyer, ticket #364]

dist/ipf/ipsend/sock.c				1.10
sys/dist/ipf/netinet/ip_nat.c			1.20
sys/dist/ipf/netinet/ip_scan.c			1.7

	Fix IPF bugs found by Coverty scans.
	[martti, ticket #356]

sys/ufs/ufs/ufs_vnops.c				1.145

	Avoids problems while reading directories on an UFS volume if the
	caller provided invalid offsets.
	[yamt, ticket #357]

sys/arch/xen/i386/autoconf.c			1.21

	Fix wedge handling under NetBSD-xen.
	[yamt, ticket #358]

sys/arch/xen/xen/xbd_xenbus.c			1.17

	Fix occasional panics in NetBSD domUs caused by a race condition.
	[bouyer, ticket #365]

sys/arch/xen/xen/xbd_xenbus.c			1.15

	PR port-xen/34005: NetBSD Xen3 domU-s can get stuck waiting for I/O.
	[yamt, ticket #360]

sys/netinet/ip_output.c				1.173

	Avoid problems if PF's fragment reassemble feature is used.
	[yamt, ticket #361]

usr.sbin/etcupdate/etcupdate			1.30

	Clean ${SRCDIR}/etc when done. Patch provided by rudolf.
	http://mail-index.netbsd.org/tech-toolchain/2007/01/11/0001.html
	[martti, ticket #359]

share/man/man9/veriexec.9			1.13
sys/dev/verified_exec.c				1.57
sys/kern/kern_verifiedexec.c			1.94
sys/sys/verified_exec.h				1.53

	veriexec_file_delete() and veriexec_table_delete() now take
	'struct lwp *' too.
	[elad, ticket #362]

share/man/man4/re.4				1.12

	- add some note and Xref for rgephy(4) and rlphy(4), as per
	  suggestion from Steve Bellovin in PR kern/35376
	- add some more 8169S based products which have their own PCI
	  vendor ID and are listed in if_re_pci.c
	- fix/remove some error messages in DIAGNOSTIC section to sync
	  with reality.
	- bump date
	[tsutsui, ticket #368]

sys/arch/i386/conf/XEN2_DOM0			1.22

	Add ciphy(4) for vge(4) and rgephy(4) for re(4).
	[tsutsui, ticket #369]

sys/dev/pci/if_nfe.c				1.8 - 1.13
sys/dev/pci/if_nfereg.h				1.2 - 1.3

	several bug fixes and hardware checksum support for nfe(4)
	[tsutsui, ticket #370]

sys/arch/sparc/sparc/machdep.c			1.266

	Allow SUN4 class machines to boot again by making process virtual
	addresses avoid the MMU "hole", as is done on SUN4C class machines.

	[jdc, ticket #372]

sys/arch/macppc/dev/ams.c			1.23
sys/arch/macppc/dev/amsvar.h			1.6

	for trackpads add a sysctl to control wether tapping causes button 
	events
	[macallan, ticket #373]

sys/kern/kern_verifiedexec.c			patch

	fix build failure introduced by ticket #362
	[elad, ticket #378]

sys/opencrypto/crypto.c				1.18

	Make the opencrypto framework work with more than one driver again.
	Fixes PR/35412.
	[daniel, ticket #367]

sys/kern/vfs_syscalls.c				1.293

	Fix issue noted by Ilja van Sprundel and disclosed at 23C3
	(file descriptor leak).
	Make sure we always FILE_UNUSE the file. To make it easier, exit
	via a new "out:" exit path that does so, setting error beforehand.
	Fix suggested by Elad, hand-typed by me.
	[wrstuden, ticket #374]

games/hack/hack.termcap.c			1.14 - 1.15

	fixes problem introduced in 1.13 where the setting of "BC"
	(backspace char) was left to libterm rather than being done by
	hack itself.  the problem with this was that hack was directly
	setting BC to \b if there was no "bc" in the termcap entry, but
	libterm does not do this.   this resulted in the xputs(BC) calls
	in nocmov() and backsp() incorrectly doing nothing, thus messing
	up the display.  added new var BC_BS to provide the old behavior
	for nocmov() and backsp().
	[chuck, ticket #375]

sys/fs/udf/udf_subr.c				1.30 - 1.31
	Use the generic clock_ymdhms_to_secs() instead of home-brewn
	version to translate UDF timestamps to timespec.
	Fix important directory lookup bug that could result in an
	endless loop. It fixes the case where a directory lookup is
	done in a directory has never been visted/listed; the search
	optimalisation that searches the directory from where it
	left behind the last time would never reach the initial offset
	of zero since it would always have at least processed one entry.
	[reinoud, ticket #376]

sys/kern/kern_sig.c				1.241 - 1.242

	Plug memory leak in __sigtimedwait1(): make sure to free `waitset'
	on error return path.
	Plug another memory leak in __sigtimedwait1() which is introduced
	by rev. 1.208: free `waitset' and ksiginfo on success.
	[enami, ticket #377]

sys/dev/isa/ug.c				1.2 - 1.3
sys/dev/isa/ugvar.h				1.2 - 1.3

	PR kern/35438: uGuru 2005 support from Mihai Chelaru.
	[xtraeme, ticket #382]


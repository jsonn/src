#       $NetBSD: CHANGES-4.0,v 1.1.4.11 2006/12/09 20:53:11 riz Exp $

A complete list of changes from the initial NetBSD 4.0 branch on
1 December 2006 until the 4.0 release:

gnu/usr.bin/groff/tmac/mdoc.local		patched by hand
sys/sys/param.h					patched by hand

	Welcome to 4.0_BETA2

sys/lib/libsa/dosfs.c				1.11

	make bootxx_msdos fit in 8k again; thanks, __internal_memset_, for
	spilling registers all over the place.
	[dogcow, ticket #240]

sys/uvm/uvm_swap.c				1.114

	We are required to hold uvm.swap_data_lock here too.
	[elad, ticket #241]

sys/dev/pci/ahcisata.c				1.2

	Don't call the done callback twice if a special action is waiting on
	the queue. Don't forget to free the xfer in the normal bio path.
	[bouyer, ticket #242]

usr.bin/msgc/msg_sys.def			1.37

	Eliminate an alloca(3) use. This is required for USE_SSP builds to
	complete.
	[tls, ticket #243]

sys/conf/Makefile.kern.inc			1.95

	Add arch/xen/i386/gdt.c to list of kernel files that do variable-size
	allocations on the stack. This allocation could potentially be quite
	large -- I am not sure how to best fix that.
	Fixes USE_SSP i386 build.sh failure.
	[tls, ticket #244]

share/man/man9/kauth.9				1.37
sys/dev/i2o/dpti.c				1.31
sys/dev/i2o/iop.c				1.62
sys/dev/ic/dpt.c				1.55
sys/dev/ic/icp_ioctl.c				1.14
sys/dev/ic/mlx.c				1.49
sys/dev/pci/amr.c				1.43
sys/dev/pci/mly.c				1.33
sys/dev/pci/twe.c				1.82
sys/dev/tc/stic.c				1.37
sys/kern/kern_auth.c				1.33
sys/secmodel/bsd44/secmodel_bsd44_securelevel.c	1.19
sys/sys/kauth.h					1.25

	Change kauth(9) KPI for kauth_authorize_device_passthru() to add
	another argument, u_long, serving as a bit-mask of generic requests
	for the passthru request.
	[elad, ticket #247]

doc/CHANGES					patch

	Add entry for etherip(4).
	[rpaulo, ticket #249]

sys/miscfs/procfs/procfs_vnops.c		1.141

	Make procfs work again for non-root users.
	[elad, ticket #248]

gnu/usr.bin/gdb53/libiberty/Makefile		1.5

	Fix SSP build for the poor archs that have not converted yet.
	[tls, ticket #250]

gnu/usr.bin/gdb53/gdb/Makefile			1.8

	Allow to build NetBSD-amd64 with USE_SSP set.
	[tls, ticket #251]

sys/ufs/ffs/ffs_snapshot.c			1.38

	Prevent kernel panics when creating snapshots on filesystems which
	uses quotas. This fixes PR kern/35121.
	[hannken, ticket #252]

share/man/man9/scheduler.9			1.4

	Update to describe current API (only), and not duplicate that can be
	found elsewhere. (And which will appear in the NetBSD Internals Guide
	soonish).
	Submitted by Daniel Sieger <dsieger@TechFak.Uni-Bielefeld.DE>,
	OK'd by martin@ and  yamt@
	[hubertf, ticket #253]

sys/arch/sparc/conf/GENERIC			1.197
sys/arch/sparc64/conf/GENERIC			1.80

	sparc64: don't enable PaX MPROTECT by default for now.
	sparc: add commented out 'FILEASSOC'.
	[elad, ticket #254]

usr.sbin/veriexecgen/veriexecgen.8		1.9
usr.sbin/veriexecgen/veriexecgen.c		1.9

	More verbose error messages in veriexecgen(8).
	Also introduce a new -W flag, which will warn the user about the
	error, but will still continue processing - it treats errors as
	warnings, and allows a signatures file to be built.
	[elad, ticket #255]

distrib/utils/sysinst/net.c			1.114

	Ensure the generated ifconfig.* file has proper media selection.
	[martin, ticket #256]

sys/kern/kern_resource.c			1.109

	Fix PR/35021: allow root cannot get/set rlimit information of user
	processes through sysctl again.
	[elad, ticket #257]

distrib/hp700/ramdisk/dot.profile		1.2
distrib/hp700/ramdisk/dot.profile		1.2
distrib/hp700/ramdisk/list			1.4
distrib/hp700/ramdisk/list			1.4
etc/etc.hp700/MAKEDEV.conf			1.3
etc/etc.hp700/MAKEDEV.conf			1.3
sys/arch/hp700/conf/majors.hp700		1.21
sys/arch/hp700/conf/majors.hp700		1.21

	Various installation fixes for hp700.
	[skrll, ticket #258]

sys/netinet/ip_etherip.c			1.2
sys/netinet6/ip6_etherip.c			1.2

	Allow etherip support to be compiled on ports other than i386.
	[jdc, ticket #259]

share/man/man9/uvm.9				1.79
sys/uvm/uvm_extern.h				1.123
sys/uvm/uvm_swap.c				1.115

	Back out uvm_is_swap_device().
	[elad, ticket #261]

sys/arch/i386/i386/powernow_k7.c		1.21

	Add another model that needs to be added into the quirk table.
	[xtraeme, ticket #262]

lib/libc/arch/sparc64/gen/resumecontext.c	1.3

	getcontext(2)/setcontext(2) fixes for sparc64.
	[martin, ticket #263]

lib/libc/arch/arm/gen/resumecontext.c		1.3
lib/libc/arch/hppa/gen/resumecontext.c		1.2
lib/libc/arch/mips/gen/resumecontext.c		1.3
lib/libc/arch/powerpc/gen/resumecontext.c	1.3
lib/libc/arch/powerpc64/gen/resumecontext.c	1.2
lib/libc/arch/sh3/gen/resumecontext.c		1.3
lib/libc/arch/sh5/gen/resumecontext.c		1.2
lib/libc/arch/sparc/gen/resumecontext.c		1.3
lib/libc/arch/vax/gen/resumecontext.c		1.2

	getcontext(2)/setcontext(2) fixes for arm, hppa, mips, powerpc,
	powerpc64, sh3,  sh5, sparc, vax.
	[martin, ticket #264]

sbin/veriexecctl/veriexecctl_parse.y		1.20

	fixes a bug where entries with multiple flags only counted the
	last flag.
	[elad, ticket #265]

doc/3RDPARTY					1.489
share/zoneinfo/zone.tab				1.1.1.27 via patch
share/zoneinfo/australasia			1.12

	tz{code,data}2006p out; tzdata2006p imported.
	[kleink, ticket #260]

sys/arch/xen/x86/consinit.c			1.7

	Remove extra ) causing compile failure when CONS_OVERRIDE is defined.
	From Hideo Masuda in PR port-xen/35217.
	[bouyer, ticket #266]


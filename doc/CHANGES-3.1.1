#	$NetBSD: CHANGES-3.1.1,v 1.1.2.17 2007/01/08 20:51:54 ghen Exp $

A complete list of changes from the NetBSD 3.1 release to the NetBSD 3.1.1
release:

File						Revision(s)
----						--------
gnu/usr.bin/groff/tmac/mdoc.local		patch
sys/sys/param.h					patch

	Welcome to 3.1.0_PATCH

sys/arch/sparc64/sparc64/locore.s		1.217-1.218 via patch

	Fix a couple of %y register save/restore errors.
	[nakayama, ticket #1517]

sys/netinet/tcp_sack.c				1.20

	Fix alignment problems causing regular panics in tpc_sack_option on
	NetBSD/alpha and NetBSD/sparc. This fixes PR#34751.

	Fix provided by Izumi Tsutsui and ok'd by Martin.
	[reinoud, ticket #1561]

sys/miscfs/specfs/spec_vnops.c			1.91 via patch

	Protect spec_poll from racing against revocation and thus
	dereferencing a NULL v_specinfo (race condition between polling
	and revoking a character device).
	[jld, ticket #1557]

sys/arch/arm/iomd/iomdkbc.c			1.3

	Interpret the argument to iomdkbc_set_poll() correctly.  Quite how we
	got this far with it the wrong way around is beyond me.
	[bjh21, ticket #1562]

sbin/dump/dump.h				1.44 via patch
sbin/dump/main.c				1.63 via patch
sbin/dump/snapshot.c				1.3 via patch
sbin/dump/snapshot.h				1.3 via patch
sbin/dump/tape.c				1.47 via patch

	When using a snapshot take the snapshot raw device on further open.
	Fixes PR #34923  dump(8) only dumps a corefile with -X (snapshots)
	[hannken, ticket #1573]

sys/kern/sys_process.c				1.112

	check for negative length in PT_COREDUMP (from Neil)
	[christos, ticket #1574]

sys/arch/xen/xen/if_xennet_xenbus.c		1.14

	Prevent xennet (Xen 3) from occasionally becoming unable to receive
	packets for several minutes when under certain types of load
	[jld, ticket #1581]

usr.sbin/postinstall/postinstall		1.30

	/etc/postfix/post-install needs to be 555 not 444.
	[lukem, ticket #1585]

sys/dev/pci/bktr/bktr_core.c			patch
	fix bug introduced by missing braces around a if() block in
	ticket #1511
	[aymeric, ticket #1587]

sys/net/if_pppoe.c				1.61

	Fix bogus uninitialized variable warning ifdef PPPOE_SERVER.
	Noticed by Marcin Jessa on current-users.
	[martin, ticket #1588]

sys/dev/ata/wd.c				1.334

	Yet another broken seagate drive: ST3160811A.
	[bouyer, ticket #1583]

games/banner/banner.c				1.16 via patch

	Check that -w width is not above maximum. (It already checks for zero
	or negative.) Using width above DWIDTH may cause overflow as noted by
	Gruzicki Wlodek on bugtraq.
	While here replace one use of 132 with DWIDTH.
	[reed, ticket #1591]

sys/netiso/esis.c				1.42

	Check parameters to avoid potential panic root user.
	Patch checked by chopps@.
	[is, ticket #1593]

lib/libc/gen/glob.c				1.13 via patch

	Don't overflow when DEBUG is defined.
	PR/30833, from Tomas Skare.
	[joerg, ticket #1596]

sys/ufs/ffs/ffs_snapshot.c			1.38

	Prevent kernel panics when creating snapshots on filesystems which
	use quotas. This fixes PR kern/35121.
	[hannken, ticket #1598]

sys/arch/xen/x86/consinit.c			1.7

	PR port-xen/35217: Fix compile failure if CONS_OVERRIDE is defined.
	[bouyer, ticket #1600]

sys/dev/vnd.c					1.153

	Don't accept a compressed vnd(4) image with block size 0 to avoid a
	kernel panic.
	[cube, ticket #1530]

dist/dhcp/server/dhcp.c				1.10

	Fix get-lease-hostnames option in dhcpd.conf(5) to make dhcpd(8) use
	the DNS hostname as the DHCP hostname given to the client.
	[drochner, ticket #1619]

sys/net/if_ethersubr.c				1.142

	Don't define dropanyway: label unless ISO or NETATALK is defined.
	Fixes a build failure for certain kernel configurations.
	[bouyer, ticket #1623]

sys/arch/xen/xen/xbd_xenbus.c			1.16

	Don't try to handle xbd interrupts if the device is not yet connected.
	Fixes a Xen3 xbd panic at boot when more than one xbd device is
	configured.
	[bouyer, ticket #1624]


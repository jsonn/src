#	$NetBSD: CHANGES-3.2,v 1.1.2.11 2006/11/14 17:49:18 bouyer Exp $

A complete list of changes from the NetBSD 3.1 release to the NetBSD 3.2
release:

File						Revision(s)
----						--------
gnu/usr.bin/groff/tmac/mdoc.local		patch
sys/sys/param.h					patch

	Welcome to 3.1_STABLE

include/stddef.h				1.11-1.15

	Fix C++ offsetof for GCC 3.4+.
	[joerg, ticket #10676]

sys/kern/kern_verifiedexec.c			1.58 via patch
sys/kern/vfs_syscalls.c				1.254 via patch
sys/sys/verified_exec.h				1.33 via patch

	Add destination file vnode to rename checking.
	[elad, ticket #1471]

share/man/man4/sk.4				1.9
sys/dev/pci/if_sk.c				1.22
sys/dev/pci/if_skvar.h				1.10

	Add jumbo frames support to the sk(4) driver.
	[riz, ticket #1480]

sys/arch/sparc64/sparc64/locore.s		1.217-1.218 via patch

	Fix a couple of %y register save/restore errors.
	[nakayama, ticket #1517]

usr.sbin/installboot/ffs.c			1.19-1.21
usr.sbin/installboot/fstypes.c			1.9
usr.sbin/installboot/installboot.8		1.54 via patch
usr.sbin/installboot/installboot.h		1.31

	Make installation of bootloaders on a RAID 1 volume easier.
	[bad, ticket #1524]

share/man/man8/man8.sparc/boot.8		1.29-1.30 + patch
sys/arch/sparc/stand/common/promdev.c		1.19

	Add support for booting from RAID 1 to the sparc boot loader.
	[jdc, ticket #1527]

etc/MAKEDEV.tmpl				1.66 (via patch)
sys/compat/freebsd/freebsd_sysctl.c		1.5 (via patch)
sys/conf/majors					1.30 (via patch)
sys/dev/pci/twa.c				1.13 (via patch)
sys/dev/pci/twaio.h				1.4 (via patch)
sys/dev/pci/twareg.h				1.6 (via patch)

	Tweak the twa(4) driver so that 3ware command line utility works with
	it.
	This includes:
	- fixing various structure definitions so that the ioctl parameter
	  match
	- adding a hw.twa*.driver_version sysctl
	- do not refuse multiple device openings, as the management tool will
	  do it.  I'm not sure we are safe. FreeBSD allows multiple openings,
	  and use the open flag only when an attempt to detach the device is
	  done.
	- While we are there, fix a bug in FreeBSD sysctl emulation: use copyin
	  for moving data to the kernel

	[manu, ticket #1528]

sys/arch/i386/conf/INSTALL			1.273
sys/arch/i386/conf/INSTALL.local		1.1
sys/arch/i386/conf/INSTALL_LAPTOP		1.92
sys/arch/i386/conf/INSTALL_SMALL		1.120
sys/arch/i386/conf/INSTALL_TINY			1.97
sys/arch/i386/conf/INSTALL_XEN2_DOMU		patch
sys/arch/i386/conf/INSTALL_XEN3_DOMU		patch

	Add (empty) INSTALL.local, parallel to GENERIC.local.
	Change INSTALL kernels to include INSTALL.local instead of
	GENERIC.local.

	With this change, one can add IPSEC in GENERIC.local and still build a
	release, rather than having install kernels not fit on floppies.

	Remaining nit: the PS2 install kernel includes the regular version
	config file, and hence GENERIC.local.

	(Posted for review on tech-pkg, encouragement to commit by lukem@, no
	objections.)
	[bad, ticket #1579]

sys/netinet/tcp_sack.c				1.20

	Fix alignment problems causing regular panics in tpc_sack_option on
	NetBSD/alpha and NetBSD/sparc. This fixes PR#34751.

	Fix provided by Izumi Tsutsui and ok'd by Martin.
	[reinoud, ticket #1561]

sys/miscfs/specfs/spec_vnops.c			1.91 via patch

	Protect spec_poll from racing against revocation and thus
	dereferencing a NULL v_specinfo (race condition between polling
	and revoking a character device).
	[jld, ticket #1557]

sys/arch/arm/iomd/iomdkbc.c			1.3

	Interpret the argument to iomdkbc_set_poll() correctly.  Quite how we
	got this far with it the wrong way around is beyond me.
	[bjh21, ticket #1562]

sbin/dump/dump.h				1.44 via patch
sbin/dump/main.c				1.63 via patch
sbin/dump/snapshot.c				1.3 via patch
sbin/dump/snapshot.h				1.3 via patch
sbin/dump/tape.c				1.47 via patch

	When using a snapshot take the snapshot raw device on further open.
	Fixes PR #34923  dump(8) only dumps a corefile with -X (snapshots)
	[hannken, ticket #1573]

sys/kern/sys_process.c				1.112

	check for negative length in PT_COREDUMP (from Neil)
	[christos, ticket #1574]

sys/dev/pci/if_wm.c				1.108

		don't reset interface on rx overrun because it makes
		the situation worse, if the overrun is merely a symptom of
		heavy load.  increament if_ierrors instead.  PR/29831.
		[hauke, ticket #1578]

sys/dev/pci/if_pcn.c				1.34

	Detect if we're talking to a VMware virtual interface, and, if so,
	limit the number of Tx segments to 8 to work around a VMware bug.
	[thorpej, ticket #1577]

sys/arch/xen/xen/if_xennet_xenbus.c		1.14

	Prevent xennet (Xen 3) from occasionally becoming unable to receive
	packets for several minutes when under certain types of load
	[jld, ticket #1581]

usr.sbin/postinstall/postinstall		1.30

	/etc/postfix/post-install needs to be 555 not 444.
	[lukem, ticket #1585]


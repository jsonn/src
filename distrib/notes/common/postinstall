.\"	$NetBSD: postinstall,v 1.9.4.9 2001/05/09 20:03:13 he Exp $
.\"
.\" Copyright (c) 1999-2001 The NetBSD Foundation, Inc.
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"        This product includes software developed by the NetBSD
.\"        Foundation, Inc. and its contributors.
.\" 4. Neither the name of The NetBSD Foundation nor the names of its
.\"    contributors may be used to endorse or promote products derived
.\"    from this software without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS
.\" ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
.\" TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
.\" PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS
.\" BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
.\" CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
.\" SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
.\" INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
.\" CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
.\" ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
.\" POSSIBILITY OF SUCH DAMAGE.
.\"
Once you've got the operating system running, there are a few
things you need to do in order to bring the system into a properly
configured state, with the most important ones described below.
.(enum
Configuring
.Pa /etc/rc.conf
.Pp
If you or the installation software haven't done any configuration of
.Pa /etc/rc.conf 
.Ic ( sysinst
usually will),
the system will drop you into single user mode on first reboot with the
message
.Pp
.Dl /etc/rc.conf is not configured. Multiuser boot aborted.
.Pp
and with the root file system
.Pq Pa /
mounted read-write. When the system
asks you to choose a shell, simply press
.Key RETURN
to get to a 
.Pa /bin/sh
prompt. If you are asked for a terminal type, respond with
.ie r_hp300 \{\
.Ic hp300h
for a local console, or whatever is appropriate for your serial console.
.\}
.el .ie r_pmax \{\
the correct terminal type as discussed in the
.Sx Once you've booted the diskimage
section.
.\}
.el .ie r_sparc \{\
.Ic sun
for a local console, or whatever is appropriate for your serial
console (some systems display garbage with a
.Ic sun
terminal type, you may need to use
.Ic sun-ss5 )
.\}
.el \{\
.Ic vt220
(or whatever is appropriate for your terminal type)
.\}
and press
.Key RETURN .
At this point, you need to configure at least
one file in the
.Pa /etc
directory. Change to the
.Pa /etc
directory and take a look at the
.Pa /etc/rc.conf
file. Modify it to your tastes, making sure that you set
.Li rc_configured=YES
so that your changes will be enabled and a multi-user boot can
proceed.
Default values for the various programs can be found in
.Pa /etc/defaults/rc.conf ,
where some in-line documentation may be found.
More complete documentation can be found in
.Xr rc.conf 5 .
.Pp
If your
.Pa /usr
directory is on a separate partition and you do not know how to use
.Ic ed ,
you will have to mount your
.Pa /usr
partition to gain access to
.Ic ex
or
.Ic vi .
Do the following:
.Pp
.Dl # Ic "mount /usr"
.ie     r_hp300 .Dl # Ic "export TERM=hp300h"
.el .ie r_pmax  .Dl # Ic "export TERM=termtype"
.el .ie r_sparc .Dl # Ic "export TERM=sun"
.el             .Dl # Ic "export TERM=vt220"
.Pp
If you have
.Pa /var
on a separate partition, you need to repeat
that step for it. After that, you can edit
.Pa /etc/rc.conf
with
.Xr vi 1 .
When you have finished, type
.Ic exit
at the prompt to
leave the single-user shell and continue with the multi-user boot.
.Pp
Other values that need to be set in
.Pa /etc/rc.conf
for a networked environment are
.Ar hostname No and possibly
.Ar defaultroute ,
furthermore add an
.Ar ifconfig_int
for your
.Aq int
network interface, 
.ie r_macppc \{\
where your on-board interfaces may be one of
.Li mc0 , bm0 , No or Li gm0
.\}
.el along the lines of
.Pp
.ie \n[hp300]:\n[pmax]:\n[sparc] \{\
.Dl                  ifconfig_le0="inet 123.45.67.89 netmask 255.255.255.0"
.\}
.el .ie r_macppc .Dl ifconfig_mc0="inet 123.45.67.89 netmask 255.255.255.0"
.el              .Dl ifconfig_de0="inet 123.45.67.89 netmask 255.255.255.0"
.Pp
or, if you have
.Ar myname.my.dom
in
.Pa /etc/hosts :
.Pp
.ie \n[hp300]:\n[pmax]:\n[sparc] \{\
.Dl                  ifconfig_le0="inet myname.my.dom netmask 255.255.255.0"
.\}
.el .ie r_macppc .Dl ifconfig_mc0="inet myname.my.dom netmask 255.255.255.0"
.el              .Dl ifconfig_de0="inet myname.my.dom netmask 255.255.255.0"
.Pp
To enable proper hostname resolution, you will also want to add an
.Pa /etc/resolv.conf
file or (if you are feeling a little more adventurous) run
.Xr named 8 .
See
.Xr resolv.conf 5
or
.Xr named 8
for more information.
.Pp
Other files in
.Pa /etc
that may require modification or setting up include
.Pa /etc/mailer.conf ,
.Pa /etc/nsswitch.conf ,
and
.Pa /etc/wscons.conf .
.ie r_arm32 \{\
.Pp
For Digital DNARD machines you will need to edit
.Pa /etc/ttys
and change the console terminal type from vt100 to pc3.
.\}
.It
Logging in
.Pp
After reboot, you can log in as
.Li root
at the login prompt. Unless you've set a password in
.Ic sysinst ,
there
is no initial password. If you're using the machine in a
networked environment, you should create an account for yourself
(see below) and protect it and the
.Dq root
account with good passwords.
Unless you have connected an unusual terminal device as the console
you can just press
.Key RETURN
when it prompts for
.Li Terminal type? [...] .
.It
Adding accounts
.Pp
Use the
.Xr useradd 8
command to add accounts to your system,
.Em do not
edit
.Pa /etc/passwd
directly. See
.Xr useradd 8
for more information on how to add a new user to the system.
.It
The X Window System
.Pp
If you have installed the X Window System, look at the files in
.Pa /usr/X11R6/lib/X11/doc
for information.
.if \n[arm32]:\n[i386] \{\
.Pp
You will need to set up a configuration file, see
.Pa /usr/X11R6/lib/X11/XF86Config.eg
for an example. The
.Xr xf86config 1
utility can interactively create a first version of such a configuration
file for you. See
.Lk http://www.xfree86.org/
and the XFree86 manual page for more information.
.\}
.Pp
Don't forget to add
.Pa /usr/X11R6/bin
to your path in your shell's dot file so that you have access to the X binaries.
.It
Installing third party packages
.Pp
If you wish to install any of the software freely available for
.Ul
systems
you are strongly advised to first check the
.Nx
package system. This automatically handles any changes necessary to
make the software run on
.Nx ,
retrieval and installation of any other packages on which the software
may depend, and simplifies installation (and deinstallation), both
from source and precompiled binaries.
.Pp
.(bullet
More information on the package system is at
.Lk http://www.netbsd.org/Documentation/software/packages.html
.It
A browsable listing of available packages is at
.Lk ftp://ftp.netbsd.org/pub/NetBSD/packages/pkgsrc/README.html
.It
Precompiled binaries can be found at
.Lk ftp://ftp.netbsd.org/pub/NetBSD/packages ,
usually in the
.Pa \*V/\*M/All
subdir.  You can install them with the following commands (line
continued to show entire line in 80 coloumn output, there's obviously
no requirement to repeat that):
.Pp
.Ic # export\ PKG_PATH=ftp://ftp.netbsd.org/pub/NetBSD/\e
.br
.Ic packages/\*V/\*M/All
.br
.Ic # pkg_add -v tcsh
.br
.Ic # pkg_add -v cvs
.br
.Ic # pkg_add -v apache
.br
.Ic # pkg_add -v perl
.br
.Ic \&...
.Pp
These commands will install the tcsh shell, the CVS source code
management system, the Apache web server and
the perl programming language as well as all the packages they
depend on. 
.It
Package sources for compiling packages on your own can be obtained by
retrieving the file
.Lk ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-current/tar_files/pkgsrc.tar.gz
They are typically extracted into
.Pa /usr/pkgsrc
(though other locations work fine), as with the command:
.Pp
.Dl # Ic "mkdir /usr/pkgsrc; tar -C /usr/pkgsrc -zxpf pkgsrc.tar.gz"
.Pp
After extracting, then see the
.Pa README
file in the extraction directory (e.g.
.Pa /usr/pkgsrc/README )
for more information.
.bullet)
.It
Misc
.(bullet
Edit
.Pa /etc/mail/aliases
to forward root mail to the right place. Don't forget to run
.Xr newaliases 1
afterwards.
.It
The
.Pa /etc/mail/sendmail.cf
file will almost definitely need to be adjusted;
files aiding in this can be found in
.Pa /usr/share/sendmail .
See the
.Li Tn README
file there for more information.
.It
Edit
.Pa /etc/rc.local
to run any local daemons you use.
.It
Many of the
.Pa /etc
files are documented in section 5 of the manual; so just invoking
.Pp
.Dl # Ic man 5 Ar filename
.Pp
is likely to give you more information on these files.
.bullet)
.enum)

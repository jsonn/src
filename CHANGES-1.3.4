#	$NetBSD: CHANGES-1.3.4,v 1.1.2.15 1999/02/03 08:02:54 cgd Exp $

Changes from NetBSD 1.3.3 to NetBSD 1.3.4:

File						Version(s)
----						--------

sys/netinet/in_pcb.c				1.56

  If INADDR_ANY is given in in_pcbconnect(), choose the ia_addr of the
  first interface, not the ia_broadaddr.  (Fixes PR#5645 and PR#6425.)
  (lukem)

sys/dev/ic/ncr53c9xvar.h			1.12
sys/dev/ic/ncr53c9x.c				1.24

  Allocate SCSI message buffers in ncr53c9x_attach(), with a provision
  for front-ends to override the allocation to avoid alignment
  handling in their DMA engines.  (Fixes PR#5180.)  (pk)

usr.bin/ftp/util.c				patch

  Fix 1.3.3 ftp's filename completion (PR#6647).  (frueauf)

sys/arch/i386/i386/ibcs2_machdep.c		patch

  Compiling a kernel with COMPAT_IBCS2 and VM86 failed due to a missing
  include of <machine/vm86.h>.  Fix that.  Fixes PR#5574 and PR#5884.
  (frueauf)

sys/sys/cdio.h					1.17
sys/isofs/cd9660/cd9660_vfsops.c		1.35
sys/dev/scsipi/cd.c				1.118

  Add multisession capability.  (Fixes PR#6093.)  (is)

lib/libc/stdio/freopen.c			1.8

  When reopening in append mode, seek to the end of file in order to have
  the internally kept offset pointer reflect this; ftell(3) would report
  an incorrect current offset otherwise.  Fixes PR#6381.  (kleink)

distrib/sparc/xsets/Makefile			1.2 (deleted)

  Remove long-unused file.  (mrg)

usr.bin/login/login.1				1.14

  Correct documentation of /etc/nologin to note that it does not
  apply to the superuser (PR#6328).  Correct some nroff nits in the
  process.  (fair)

usr.sbin/dhcp/server/Makefile			1.4
usr.sbin/dhcp/server/dhcpd.c			1.2

  Don't use the 'Name' RCS keyword; it makes builds harder.  Instead
  use a version string defined by the Makefile.  (cgd)

sys/arch/amiga/dev/sbicvar.h			1.13
sys/arch/amiga/dev/sbicreg.h			1.3
sys/arch/amiga/dev/atzsc.c			1.25
sys/arch/amiga/dev/gtsc.c			1.24
sys/arch/amiga/dev/sbic.c			1.33
sys/arch/amiga/dev/ahsc.c			1.21-1.22

  Makes the ahsc (Amiga 3000 mainboard SCSI) driver also work for A3000
  machines that have been reworked to support the Apollo3060 CPU
  accelerator board.  (is)

usr.bin/netstat/if.c				1.30
usr.bin/netstat/main.c				1.18
usr.bin/netstat/netstat.h			1.11
usr.bin/netstat/route.c				1.33

  Don't include 'wierd' network spport if "SMALL" is defined, to
  enable a much smaller netstat to be built, which is useful for boot
  media.  (mrg)

distrib/utils/x_netstat/Makefile		1.1 (new)

  Build a netstat without 'weird' network support or multicasting
  suppport.  (mrg)

distrib/utils/x_gzip/Makefile			1.1 (new)
distrib/utils/x_gzip/gzip.c			1.1 (new)
distrib/utils/x_gzip/gzip.1			1.1 (new)

  zlib-based (almost) fully featured free gzip clone, which is
  significantly smaller than the GNU version.  (mrg)

sys/arch/sparc/stand/common/newvers.sh		1.2
sys/arch/sparc/stand/boot/version		1.8-1.9

  Generate boot program version in a manner suitable for branches.  (mrg)

sys/arch/sparc/stand/boot/boot.c		1.3

  If /netbsd cannot be booted, look for kernels named /netbsd.gz,
  /netbsd.old, /netbsd.old.gz, /onetbsd, /onetbsd.gz, and /vmunix.  (mrg)

bin/pax/cache.c					patch

  This fixes a memory leak (due to never actually adding items to the
  hash table).  It may therefore also fix some problems with installing
  on machines with little memory.  (mycroft)

sbin/disklabel/disklabel.c			1.58 (patch)

  Fix a type overflow problem that prevents correct operation on large
  disks in some circumstances (PR#5534).  (drochner)

sys/arch/pmax/dev/rz.c				1.41

  Fixes RZ25 spinup failure: it seems to need a short delay after the
  start command completes.  RZ25 drives would spin up, but would not
  be recognized by the driver during that probe.  (mhitch)

usr.sbin/portmap/Makefile			1.9
usr.sbin/portmap/portmap.c			1.13-1.18
usr.sbin/portmap/portmap.8			1.5

  Fixes possible denial of service attacks from forged SET and UNSET
  calls, and adds logging features.  (mycroft and drochner)

sys/kern/uipc_socket.c				patch
sys/kern/uipc_socket2.c				patch
sys/sys/socketvar.h				patch

  Fix select(2)/accept(2) race condition which permits denial of
  service.  (mycroft)

distrib/sparc/Makefile                         1.1-1.2 (new)
distrib/sparc/Makefile.inc                     1.1-1.3 (new)
distrib/sparc/bootfs/Makefile                  1.1-1.9 (new)
distrib/sparc/bootfs/list                      1.1 (new)
distrib/sparc/ramdisk/Makefile                 patch (new)
distrib/sparc/ramdisk/disktab.preinstall       1.1 (new)
distrib/sparc/ramdisk/dot.profile              1.1-1.3 (new)
distrib/sparc/ramdisk/list                     patch (new)
distrib/sparc/ramdisk/mtree.conf               1.1-1.3 (new)
distrib/sparc/ramdisk/ramdiskbin.conf          patch (new)
distrib/sparc/ramdisk/termcap.src              1.1-1.2 (new)

  Build a ramdisk filesystem image for install/recover type media.
  Build a bootable floppy image using the ramdisk, that can also be
  used to build bootable CD-ROMs.  (mrg)

sys/arch/vax/include/float.h			1.5

  Make DBL_MIN and DBL_MAX match limits.h to avoid compile
  warnings.  (abs)

sys/nfs/nfs_serv.c				1.46

  Allow non-root users to create named pipes on NetBSD NFS file
  systems, like all other NFS servers.  (mrg)

sys/arch/pmax/tc/scc.c				1.45

  Fix scc speedtab handling and enable 78.6k and 115.2k
  (PR#6848).  (jonathan)

etc/etc.sparc/disktab				1.5-1.8

  Give floppy entry a BSD partition type in partition a.  Add an
  "instfs" entry used to build the ramdisk.  (mrg)

usr.bin/vi/cl/cl_screen.c			1.2-1.3

  If TERM was unset vi would report 'no such file or directory'.
  Now reports 'terminal type unknown'.  (abs)

sys/arch/alpha/include/stdarg.h			1.8
sys/arch/arm32/include/stdarg.h			1.4
sys/arch/arm32/include/varargs.h		1.4
sys/arch/i386/include/stdarg.h			1.13-1.15
sys/arch/m68k/include/stdarg.h			1.15-1.16
sys/arch/mips/include/stdarg.h			1.12-1.14
sys/arch/mips/include/varargs.h			1.14-1.16
sys/arch/pc532/include/stdarg.h			1.13-1.14
sys/arch/sparc/include/stdarg.h			1.11
sys/arch/vax/include/stdarg.h			1.9-1.10

  Use __builtin_next_arg(), since the `last' argument is a variable, and
  may have been moved by code before va_start().  Fixes PR#6862 and
  PR#6923.  (mycroft)

etc/man.conf					1.11-1.13

  Remove references to obsolete directories (PR#5599), sort sections in
  a consistent order, and add sections 'n' and 'l' for pkg, X11, and
  local manual pages.  (abs)

sys/dev/ic/z8530tty.c                           patch

  Revert pullup of revision 1.53 done for NetBSD 1.3.3.  It caused
  problems for various users of the serial port, e.g. ppp.  (wrstuden)

etc/services					1.27-1.30

  Add services use by various packages.  Fixes PR#5675.  (hwr)

usr.bin/less/less/main.c			1.7

  Use lgetenv() for "LESS" and "MORE" variables.  (simonb)

sys/dev/ic/i82365.c				patch

  Improve PCMCIA card powerup sequence.  (msaitoh)

sys/arch/pmax/stand/Makefile			1.11
sys/arch/pmax/stand/Makefile.booters		1.11-1.14
sys/arch/pmax/stand/Makefile.inc		1.1-1.3 (new)
sys/arch/pmax/stand/README			1.3 (deleted)
sys/arch/pmax/stand/boot.c			1.7 (deleted)
sys/arch/pmax/stand/byteswap.h			1.3 (deleted)
sys/arch/pmax/stand/conf.c			1.6 (deleted)
sys/arch/pmax/stand/dec_boot.h			1.5 (deleted)
sys/arch/pmax/stand/dec_exec.h			1.5 (deleted)
sys/arch/pmax/stand/dec_label/Makefile		1.2 (deleted)
sys/arch/pmax/stand/dec_label/dec_label.c	1.5 (deleted)
sys/arch/pmax/stand/dec_prom.h			1.10 (deleted)
sys/arch/pmax/stand/filesystem.c		1.3 (deleted)
sys/arch/pmax/stand/libsa/Makefile		1.6, 1.7, 1.8, 1.9
sys/arch/pmax/stand/libsa/Makefile		1.6-1.9
sys/arch/pmax/stand/libsa/alloc.c		1.1-1.2 (new)
sys/arch/pmax/stand/libsa/alloc.c		1.1-1.2 (new)
sys/arch/pmax/stand/libsa/callvec.c		1.8
sys/arch/pmax/stand/libsa/callvec.c		1.8
sys/arch/pmax/stand/libsa/dec_boot.h		1.1-1.4 (new)
sys/arch/pmax/stand/libsa/dec_exec.h		1.1-1.4 (new)
sys/arch/pmax/stand/libsa/dec_prom.h		1.1-1.9 (new)
sys/arch/pmax/stand/libsa/devopen.c		1.7
sys/arch/pmax/stand/libsa/getenv.c		1.8
sys/arch/pmax/stand/libsa/gets.c		1.8
sys/arch/pmax/stand/libsa/read.c		1.1-1.2 (new)
sys/arch/pmax/stand/libsa/strcat.c		1.8
sys/arch/pmax/stand/libsa/strcmp.c		1.7
sys/arch/pmax/stand/libsa/strcpy.c		1.8
sys/arch/pmax/stand/libsa/ufs.c			1.1-1.3 (new)
sys/arch/pmax/stand/mkboot.c			1.6 (deleted)
sys/arch/pmax/stand/mkboottape.c		1.8 (deleted)
sys/arch/pmax/stand/rz.c			1.7 (deleted)
sys/arch/pmax/stand/scsiboot/Makefile		patch (new)
sys/arch/pmax/stand/scsiboot/boot.c		1.1-1.8 (new)
sys/arch/pmax/stand/scsiboot/byteswap.h		1.1-1.2 (new)
sys/arch/pmax/stand/scsiboot/conf.c		1.1-1.7 (new)
sys/arch/pmax/stand/scsiboot/filesystem.c	1.1-1.2 (new)
sys/arch/pmax/stand/scsiboot/mkboot.c		1.1-1.6 (new)
sys/arch/pmax/stand/scsiboot/mkboottape.c	1.1-1.9 (new)
sys/arch/pmax/stand/scsiboot/rz.c		1.1-1.8 (new)
sys/arch/pmax/stand/scsiboot/rz.h		1.1 (new)
sys/arch/pmax/stand/scsiboot/start.S		1.1-1.4 (new)
sys/arch/pmax/stand/scsiboot/tz.h		1.1 (new)
sys/arch/pmax/stand/start.S			1.3 (deleted)

  Provide working bootblocks for the pmax. (simonb)

sys/compat/linux/syscalls.master		1.24
sys/compat/linux/linux_syscall.h		patch
sys/compat/linux/linux_syscallargs.h		patch
sys/compat/linux/linux_syscalls.c		patch
sys/compat/linux/linux_sysent.c			patch

  Make Linux emulation handle nanosleep().  (drochner)

gnu/usr.bin/groff/grotty/Makefile		patch
gnu/usr.bin/groff/troff/Makefile		patch

  Avoid g++ optimisation bugs in 2.7.2.2 that cause troff and
  grotty to crash on vax.  (abs)

share/zoneinfo/africa				1.1.1.4-1.1.1.7
share/zoneinfo/antarctica			1.1.1.2-1.1.1.4
share/zoneinfo/asia				1.1.1.3-1.1.1.6
share/zoneinfo/australasia			1.1.1.3-1.1.1.7
share/zoneinfo/backward				1.1.1.2-1.1.1.3
share/zoneinfo/etcetera				1.1.1.2-1.1.1.3
share/zoneinfo/europe				1.1.1.3-1.1.1.6
share/zoneinfo/factory				1.1.1.2
share/zoneinfo/iso3166.tab			1.1.1.3
share/zoneinfo/northamerica			1.1.1.3-1.1.1.7
share/zoneinfo/pacificnew			1.1.1.2
share/zoneinfo/southamerica			1.1.1.3-1.1.1.7
share/zoneinfo/zone.tab				1.1.1.3-1.1.1.5

  Update to tzdata1999b.  (mrg)

bin/df/df.1					1.15-1.16

  Document negative "available" space values (PR#6919).  (bouyer)

sys/netinet/ip_mroute.c				1.40

  Fix stray pointer that confused netstat(1) after mrouting was
  disabled (PR#5400).  (mycroft)

etc/etc.sparc/MAKEDEV				patch

  Add a description for "floppy" devices.  Build mdN[abc] memory
  disk devices.  (mrg)
